#!groovy

node {
       stage('Checkout'){
          checkout scm
       }

       stage('Install'){
          sh 'node -v'
          sh 'npm prune'
          sh 'npm install'
       }

       stage('Static check'){
          sh './node-modules/.bin/eslint *.js routes/*.js'
       }

       stage('Test'){
         env.NODE_ENV = "test"
         print "Environment will be : ${env.NODE_ENV}"
         sh 'npm test'

       }

    }
